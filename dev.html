<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Galaxy Looping Squares</title>
<style>
  html, body {
    margin: 0; padding: 0; height: 100%; overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #0a0a1a;
  }

  #particles-js {
    position: fixed;
    width: 100%; height: 100%; top: 0; left: 0;
    z-index: 0;
    background: radial-gradient(ellipse at center, #1b2735 0%, #090a0f 100%);
  }

  .carousel-wrapper {
    position: relative;
    width: 100vw;
    height: 100vh;
    overflow: visible;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1;
  }

  .square {
    position: absolute;
    background: rgba(255 255 255 / 0.1);
    border: 2px solid rgba(255 255 255 / 0.3);
    border-radius: 20px;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-weight: 600;
    font-size: 1.4rem;
    cursor: pointer;
    transition: all 0.5s cubic-bezier(0.4,0,0.2,1);
    opacity: 0;
    pointer-events: none;
    user-select: none;
  }

  .square.center {
    width: 400px; height: 400px;
    opacity: 1;
    pointer-events: auto;
    transform: translateX(0) translateZ(0);
    z-index: 10;
  }

  .square.left {
    width: 150px; height: 150px;
    opacity: 0.5;
    pointer-events: auto;
    z-index: 5;
    transform: translateX(-350px);
  }

  .square.right {
    width: 150px; height: 150px;
    opacity: 0.5;
    pointer-events: auto;
    z-index: 5;
    transform: translateX(350px);
  }

  .square:hover {
    transform: scale(1.05) translateY(-8px);
    box-shadow: 0 15px 40px rgba(255,255,255,0.35);
  }

  @media (max-width: 600px) {
    .square.center {
      width: 200px; height: 200px;
    }
    .square.left, .square.right {
      width: 100px; height: 100px;
    }
    .square.left {
      transform: translateX(-150px);
    }
    .square.right {
      transform: translateX(150px);
    }
  }
</style>
</head>
<body>

<div id="particles-js"></div>

<div class="carousel-wrapper" id="wrapper">
  <div class="square" data-link="index.html">Home</div>
  <div class="square" data-link="Computer_Science.html">Computer Science</div>
  <div class="square" data-link="about-me.html">About Me</div>
  <div class="square" data-link="#">Friends</div>
  <div class="square" data-link="#">Marching Band Game</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script>
  particlesJS("particles-js", {
    particles: {
      number: { value: 100, density: { enable: true, value_area: 1200 } },
      color: { value: "#ffffff" },
      shape: { type: "circle" },
      opacity: {
        value: 0.3,
        random: true,
        anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false }
      },
      size: {
        value: 2,
        random: true,
        anim: { enable: true, speed: 2, size_min: 0.5, sync: false }
      },
      line_linked: {
        enable: true,
        distance: 120,
        color: "#aaa",
        opacity: 0.08,
        width: 1
      },
      move: {
        enable: true,
        speed: 0.4,
        direction: "none",
        random: true,
        straight: false,
        out_mode: "out",
        bounce: false
      }
    },
    interactivity: {
      detect_on: "canvas",
      events: { onhover: { enable: false }, onclick: { enable: false }, resize: true }
    },
    retina_detect: true
  });

  const squares = document.querySelectorAll('.square');
  const total = squares.length;
  let currentIndex = 0;

  function updateSquares() {
    squares.forEach((sq, i) => {
      sq.classList.remove('center', 'left', 'right');
      sq.style.opacity = '0';
      sq.style.pointerEvents = 'none';
      sq.style.zIndex = '1';
      sq.style.transform = '';
    });

    const center = squares[currentIndex];
    center.classList.add('center');
    center.style.opacity = '1';
    center.style.pointerEvents = 'auto';
    center.style.zIndex = '10';

    const leftIndex = (currentIndex - 1 + total) % total;
    const rightIndex = (currentIndex + 1) % total;

    const left = squares[leftIndex];
    left.classList.add('left');
    left.style.opacity = '0.5';
    left.style.pointerEvents = 'auto';
    left.style.zIndex = '5';

    const right = squares[rightIndex];
    right.classList.add('right');
    right.style.opacity = '0.5';
    right.style.pointerEvents = 'auto';
    right.style.zIndex = '5';
  }

  // Throttle scroll to prevent stacking glitches
  let scrollTimeout;
  window.addEventListener('wheel', e => {
    e.preventDefault();
    if(scrollTimeout) return;

    if (e.deltaY > 0) currentIndex = (currentIndex + 1) % total;
    else currentIndex = (currentIndex - 1 + total) % total;

    updateSquares();

    scrollTimeout = setTimeout(() => {
      scrollTimeout = null;
    }, 300);
  }, { passive: false });

  // Swipe handling for mobile
  let startX = 0;
  window.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
  });
  window.addEventListener('touchend', e => {
    const endX = e.changedTouches[0].clientX;
    if (startX - endX > 50) currentIndex = (currentIndex + 1) % total;
    else if (endX - startX > 50) currentIndex = (currentIndex - 1 + total) % total;
    updateSquares();
  });

  // Only link valid squares
  squares.forEach(sq => {
    sq.addEventListener('click', () => {
      const url = sq.getAttribute('data-link');
      if (url && url !== '#') {
        window.location.href = url;
      }
    });
  });

  updateSquares();
  window.addEventListener('resize', updateSquares);
</script>
</body>
</html>
